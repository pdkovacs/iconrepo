# Loki

## Grafana Cloud

### Add extra labels

The command to configure and install promtail on a kubernetes cluster is typically something like

```
curl -fsS https://raw.githubusercontent.com/grafana/loki/master/tools/promtail.sh | sh -s <instance-id> <Your Grafana.com API Key> logs-prod-012.grafana.net default | kubectl apply --namespace=default -f  -
```

To attach a label `hostname` with the value `macos` to all records collected, inserting a step like this into the shell pipeline immediately before the shell script execution (to alter the script to be executed) would do the job:

```
sed "/      - args:/a\        - -client.external-labels=hostname=macos"
```

The whole command would then look something like this:

```
curl -fsS https://raw.githubusercontent.com/grafana/loki/master/tools/promtail.sh | sed "/      - args:/a\        - -client.external-labels=hostname=macos" | sh -s <instance-id> <Your Grafana.com API Key> logs-prod-012.grafana.net default | kubectl apply --namespace=default -f  -
```

Before applying, it is obviously worthwhile to check whether the change makes sense syntactically with the current version of the yaml file structure generated by `promptail.sh`.

Tip:

```
echo -n hostname: 
read hostname
echo -n My grafana.com API key:  
read -s my_grafana_api_key
curl -fsS https://raw.githubusercontent.com/grafana/loki/master/tools/promtail.sh | sed "/      - args:/a\        - -client.external-labels=hostname=$hostname" | sh -s 465842 $my_grafana_api_key logs-prod-012.grafana.net default | kubectl apply --namespace=default -f  -
```
